%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% XeTeX
%
% Dicionário Chinês -> Português
% Autor: Luiz Eduardo Roncato Cordeiro
%
% Licença:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\documentclass[a4paper,12pt,twoside,openany,draft]{memoir}
\documentclass[a4paper,12pt,twoside,openany]{memoir}

\usepackage[usenames,dvipsnames]{color}
\usepackage[utf8]{inputenc}
\usepackage[brazil]{babel}
\usepackage{fontspec}
\usepackage{xltxtra}
\usepackage{xeCJK}
\usepackage{xpinyin}
\usepackage{xunicode}
\usepackage{xltxtra}
\usepackage{multicol}
\usepackage{fancyhdr}
\usepackage{imakeidx}
\usepackage{ifthen}
\usepackage{tocloft}
\usepackage{xparse}
\usepackage{enumitem}
\usepackage{zhnumber}
\usepackage{wasysym}

\setCJKmainfont{AR PL UKai CN}
\setCJKsansfont{AR PL UMing CN}

\makeindex[columns=3, title=Índice, intoc]

\setlength{\parindent}{0em}
\setlength{\parskip}{0.5em}
\setlength{\columnsep}{1em}
\setlength{\columnseprule}{0.2mm}

\xpinyinsetup{ratio={.5},vsep={1em},multiple={\color{Sepia}}}

% Headers & footers
\fancyhead[L]{\rightmark} % Top left header
\fancyhead[R]{\leftmark}  % Top right header
\renewcommand{\headrulewidth}{1.4pt} % Rule under the header
\fancyfoot[C]{\thepage} % Bottom center footer
\renewcommand{\footrulewidth}{1.4pt} % Rule under the header
\pagestyle{fancy} % Use the custom headers and footers throughout the document

\setlength{\headheight}{16pt}
\addtolength{\topmargin}{-0.5pt}

\NewDocumentCommand\mylist{>{\SplitList{|}}m}
{
\setlength{\leftmargin}{0em}
\begin{enumerate}[nosep,left=0em]
  \ProcessList{#1}{ \insertitem }
\end{enumerate}
}
\newcommand\insertitem[1]{\item #1}

\newenvironment{verbete}[2][]
  {\leavevmode
  \ifthenelse{\equal{#1}{}}%
    {\markboth{#2}{#2}\index{#2}}%
    {\markboth{#2«\pinyin{#1}»}{#2«\pinyin{#1}»}\index{#2«\pinyin{#1}»}}
  \begin{minipage}[t][][t]{\linewidth}
  {\LARGE \textbf{#2}}
  }
  {
  \end{minipage}
  }

%\newcommand{\entry}[4]{\markboth{#1}{#1}\textbf{#1}\ {(#2)}\ \textit{#3}\ $\bullet$\ {#4}}  
% Defines the command to print each word on the page, \markboth{}{} prints the first word on the page in the top left header and the last word in the top right

\newenvironment{pronuncia}[2][]
  {\ifthenelse{\equal{#1}{}}{}{#1}%
  «\pinyin{#2}»\\
  }
  {}

\newcommand{\significado}[3][]{%
\if\relax\detokenize{#2}\relax\else$\bullet$\ (\textit{#2})\fi%
\ifthenelse{\equal{#1}{}}{}{ [P.C.:\xpinyin*{#1}]}%
{\small \mylist{#3}}%
\vspace{1ex}
}

\newcommand{\e}[1]{\textcolor{OliveGreen}{#1}}
%\newcommand{\pc}[1]{P.C.:#1}

\makeatletter
\let\old@makechapterhead\@makechapterhead
% Taken from http://mirrors.ctan.org/macros/latex/unpacked/report.cls
\def\fake@makechapterhead#1{%
  \vspace*{50\p@}%
  {\parindent \z@ \raggedright \normalfont
    \ifnum \c@secnumdepth >\m@ne
        \huge\bfseries \strut%\@chapapp\space \thechapter
        \par\nobreak
        \vskip 20\p@
    \fi
    \interlinepenalty\@M
    \Huge \bfseries #1\par\nobreak
    \vskip 40\p@
  }
  \markboth{#1}{\thechapter}
}
\newcommand{\newchapterhead}{\let\@makechapterhead\fake@makechapterhead}
\newcommand{\restorechapterhead}{\let\@makechapterhead\old@makechapterhead}
\makeatother

\DeclareRobustCommand{\&}{%
    \ifdim\fontdimen1\font>0pt
        \textsl{\symbol{`\&}}%
    \else
        \symbol{`\&}%
    \fi
}

%%%
%%% Documento começa aqui!
%%%

\begin{document}

\newchapterhead

\begin{titlingpage} % Suppresses displaying the page number on the title page and the subsequent page counts as page 1
	
	\raggedleft % Right align the title page
	
	\rule{1pt}{\textheight} % Vertical line
	\hspace{0.05\textwidth} % Whitespace between the vertical line and title page text
	\parbox[b]{0.75\textwidth}{ % Paragraph box for holding the title page text, adjust the width to move the title page left or right on the page
		
		{\Huge\bfseries 汉葡词典}\\[2\baselineskip] % Title
		{\large\textsc{Dicionário Chinês-Português para o \\Curso de Chinês do Instituto Confúcio}}\\[4\baselineskip] % Subtitle or further description
        {\Large\textsc{罗学凯}\\\tiny Luiz Eduardo Roncato Cordeiro} % Author name, lower case for consistent small caps
		
		\vspace{0.5\textheight} % Whitespace between the title block and the publisher
		
		{\noindent \zhtoday}\\[\baselineskip] % Publisher and logo
	}

\end{titlingpage}

\tableofcontents

\newpage

\chapter{Termos Gramaticais Chineses}

\begin{tabular}{lll}
nome/substantivo       & \textbf{n.}        & 名词 \\
palavra de lugar       & \textbf{p.d.l.}    & 处所词 \\
palavra de localização & \textbf{p.l.}      & 方位词 \\
palavra de tempo       & \textbf{p.t.}      & 时间词 \\
verbo                  & \textbf{v.}        & 动词 \\
verbo direcional       & \textbf{v.d.}      & 趣向\hspace{1em}动词 \\
verbo optativo         & \textbf{v.o.}      & 能缘\hspace{1em}动词 \\
adjetivo               & \textbf{adj.}      & 形容词 \\
numeral                & \textbf{num.}      & 数词 \\
palavra classificadora & \textbf{p.c.}      & 两量词 \\
pronome                & \textbf{pron.}     & 代词 \\
interrogativo          & \textbf{interr.}   & 疑问词 \\
advérbio               & \textbf{adv.}      & 副词 \\
preposição             & \textbf{prep.}     & 介词 \\
conjunção              & \textbf{conj.}     & 连词 \\
partícula              & \textbf{part.}     & 助词 \\
sujeito                & \textbf{suj.}      & 主语 \\
objeto                 & \textbf{obj.}      & 宾语 \\
atributo               & \textbf{atrib.}    & 定语 \\
adjunto adverbial      & \textbf{a.adv.}    & 状语 \\
complemento            & \textbf{compl.}    & 补语 \\
verbo+complemento      & \textbf{v.+compl.} & 动宾式\hspace{1em}离合词 \\
expressão idiomática   & \textbf{expr.}     & \\
\end{tabular}

\newpage

\chapter{汉葡词典}

%%%
%%% Estou ordenando as palavras em ordem alfabética por pinyin.
%%% Obs: Para as palavras diferentes com o mesmo pinyin, a que tem o menor 
%%%      número de traços vem antes.
%%%

\clearpage
\input{verbetes/A.tex}
\input{verbetes/B.tex}
\input{verbetes/C.tex}
\input{verbetes/D.tex}
\input{verbetes/E.tex}
\input{verbetes/F.tex}
\input{verbetes/G.tex}
\input{verbetes/H.tex}
%\input{verbetes/I.tex} %%%%% Não tem palavras com pinyin iniciado em "I" em chinês
\input{verbetes/J.tex}
\input{verbetes/K.tex}
\input{verbetes/L.tex}
\input{verbetes/M.tex}
\input{verbetes/N.tex}
\input{verbetes/O.tex}
\input{verbetes/P.tex}
\input{verbetes/Q.tex}
\input{verbetes/R.tex}
\input{verbetes/S.tex}
\input{verbetes/T.tex}
%\input{verbetes/U.tex} %%%%% Não tem palavras com pinyin iniciado em "U" em chinês
%\input{verbetes/V.tex} %%%%% Não tem palavras com pinyin iniciado em "V" em chinês
\input{verbetes/W.tex}
\input{verbetes/X.tex}
\input{verbetes/Y.tex}
\input{verbetes/Z.tex}

\printindex

\end{document}
